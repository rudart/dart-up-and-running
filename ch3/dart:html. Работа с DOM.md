# dart:html. Работа с DOM
Если вы хотите использовать DOM, Вам должны быть известны объекты windows, documents, elements, и nodes.

Объект [Window](http://api.dartlang.org/html/Window.html), представляет фактическое окно браузера. Каждое окно имеет объект Document, который указывает на загруженный в данный момент документ. Объект Window также имеет средства доступа к различным API, такие как IndexedDB (для хранения данных), requestAnimationFrame (для анимации), и многое другое. В браузерах каждая вкладка имеет свой собственный объект Window.
Используя объект [Document](http://api.dartlang.org/html/Document.html) можно создавать и манипулировать [элементами (Elements)](http://api.dartlang.org/html/Element.html) в документе. Следует отметить, объект Document сам является элементом и так же с успехом им можно управлять.
Модель DOM представляет собой дерево [узлов (Nodes)](http://api.dartlang.org/html/Node.html). Чаще всего они являются элементами, так же они могут быть атрибутами, текстом, коментариями и другими типами DOM. За исключением самого первого узла (root node), который не имет родительского элемента, каждый узел в DOM имеет одного родителя и может иметь много потомков.

## Поиск элементов
Для манипулирования элементом, сперва нужен объект который будет представлять этот элемент. Этот объект можно получить используя запросы.

Для поиска одного или нескольких элементов используются функции высшего уровня querySelector() и querySelectorAll(). Запрос может быть произведен по id, классу, тегу, имени или по любой из этих комбинаций. [Спецификация CSS](http://www.w3.org/TR/css3-selectors/) определяет формат селекторов таких как *"#"* - для идентификаторов, и *"."* - для классов.

Функция querySelector() возвращает первый элемент, который соответствует запросу, в то время как querySelectorAll() возвращает коллекцию всех элементов, которые соответствуют запросу.
```
Element elem1 = querySelector('#an-id');           // Отбирается элемент по идентификатору (an-id).
Element elem2 = querySelector('.a-class');         // Отбираются элемент по классу (a-class).
List<Element> elems1 = querySelectorAll('div');    // Отбираются все элементы по тегу (<div>).
List<Element> elems2 = querySelectorAll('input[type="text"]'); // Отбираются все поля для ввода текста.
   
   // Находятся все элементы с CSS классом 'class' внутри тега <p>
   // которые находятся в элементе с ID 'id'.
   List<Element> elems3 = querySelectorAll('#id p.class');
   ```
   
   ## Манипулирование элементами
   Вы можете использовать свойства для изменения состояния элемента. Класс Node и его подтип Element определяют все свойства которые имеют элементы. К примеру все элементы имеют classes, hidden, id, style, и title свойства которые вы можете использовать для задания состояния. Подклассы класса Element определяют дополнительные свойства, такие как *href* который принадлежит классу [AnchorElement](http://api.dartlang.org/html/AnchorElement.html).
   
   Пример использования элемента anchor в html:
   ```
   <a id="example" href="http://example.com">Текст ссылки</a>
   ```
Тег <a> определяет элемент с href атрибутом и текстовым узлом (доступным через свойства) который содержит текст "Текст ссылки". Для изменения URL ссылки может быть использовано свойство href объекта AnchorElement:
```
querySelector('#example').href = 'http://dartlang.org';
```

Часто бывает необходимо установить свойства для многих элементов. Например, следующий код устанавливает скрытое свойство всех элементов которые имеют класс "mac", "win" или "linux". Установка hidden своства в значении true имеет тот же эффект что и display:none в CSS.

```
<!-- In HTML: -->
<p>
  <span class="os linux">Words for Linux</span>
  <span class="os mac">Words for Mac</span>
  <span class="os win">Words for Windows</span>
</p>
// In Dart:
final osList = ['mac', 'win', 'linux'];

var userOs = 'linux'; // В реальном коде нужно определять это програмный путем.

for (var os in osList) {            // Для каждой возможной OS...
  bool shouldShow = (os == userOs); // Проверяется соответствует ли эта os os пользователя 
  for (var elem in querySelectorAll('.$os')) { // Находятся все элементы для этой OS.
    elem.hidden = !shouldShow;      // Каждый элемент можно скрыть или показать.
  }
}
```

Когда нужное свойство не доступно или отсутствует, Вы можете использовать атрибуты свойств элементов. Эти свойства записываются как хеш Map<String, String>, где ключи это и есть имена атрибутов. Что бы увидеть весь список атрибутов и их значений см. MDN на странице посвященной атрибутам. Вот пример установки значения атрибута: 
```
elem.attributes['someAttribute'] = 'someValue';
```

## Создание элементов
Элементы можно создавать и добавлять в DOM существующих html страниц. Пример создание параграфа (<p>):
```
var elem = new ParagraphElement();
elem.text = 'Creating is easy!';
```
Элемент так же можно создать путем парсинга html размертки. Любой вложенный элемент будет проаналезирован и создан.
```
var elem2 = new Element.html('<p>Creating <em>is</em> easy!</p>');
```
Следует отметить, что elem2 является ParagraphElement в приведенном выше примере.

Добавляя созданный элемент в документ, можно назначить его родительский элемент. Так же элемент можно добавлять во вложенный элемент любого существующего элемента. В следующем примере body является элементом, а его вложенные элементы доступны как (List<Element>) свойства объекта children.

## Добавление, замещение и удаление узлов
Напомню, что элементы являются своего рода узлами. Вы можете отобрать все вложенные элементы узла используя свойство node объекта Node, которое возвращяется в виде списка List<Node> (за исключением потомков которые не являются узлами Element). Если у Вас есть этот список, Вы можете использовать обычные методы объекта List и его операторы для манипулирования потомками узла.

Для добавления потомка в качестве последнего элеента содержащего его узла, используется метод объекта List - add():
```
// По id находится родительский элемент и в качестве последнего потомка добавляется новый элемент elem
querySelector('#inputs').nodes.add(elem);
```
Для замены узла используется метод объекта Node replaceWith():
```
// Узел находится по ID, и заменяется прямо в DOM.
querySelector('#status').replaceWith(elem);
```
Чтобы удалить узел используется метод remove():
// Отбирается узел по id, и удаляется из DOM.
querySelector('#expendable').remove();